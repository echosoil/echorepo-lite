{% extends 'base.html' %}
{% block title %}Search samples{% endblock %}

{% block content %}
  <h2 class="h4 mb-3">Search samples</h2>
  <form method="post" class="card p-3 mb-4">
    <div class="row g-3">
      <div class="col-md-4">
        <label class="form-label">Sample / QR</label>
        <input type="text" name="sample_id" class="form-control" value="{{ criteria.sample_id }}">
      </div>
      <div class="col-md-2">
        <label class="form-label">Country</label>
        <input type="text" name="country_code" class="form-control" value="{{ criteria.country_code }}" maxlength="2">
      </div>
      <div class="col-md-2">
        <label class="form-label">pH min</label>
        <input type="number" step="0.1" name="ph_min" class="form-control" value="{{ criteria.ph_min }}">
      </div>
      <div class="col-md-2">
        <label class="form-label">pH max</label>
        <input type="number" step="0.1" name="ph_max" class="form-control" value="{{ criteria.ph_max }}">
      </div>
      <div class="col-md-2">
        <label class="form-label">Date from</label>
        <input type="date" name="date_from" class="form-control" value="{{ criteria.date_from }}">
      </div>
      <div class="col-md-2">
        <label class="form-label">Date to</label>
        <input type="date" name="date_to" class="form-control" value="{{ criteria.date_to }}">
      </div>
    </div>
    <div class="mt-3">
      <button type="submit" class="btn btn-primary">Search</button>
    </div>
  </form>

  {% if rows %}
    <div class="table-responsive">
      <table class="table table-sm align-middle">
        <thead>
          <tr>
            <th>sample_id</th>
            <th>timestamp</th>
            <th>country</th>
            <th>pH</th>
            <th>lat</th>
            <th>lon</th>
            <th>collected_by</th>
          </tr>
        </thead>
        <tbody>
          {% for r in rows %}
          <tr>
            <td>{{ r.sample_id }}</td>
            <td>{{ r.timestamp_utc }}</td>
            <td>{{ r.country_code }}</td>
            <td>{{ r.ph }}</td>
            <td>{{ r.lat }}</td>
            <td>{{ r.lon }}</td>
            <td>{{ r.collected_by }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% elif criteria.sample_id or criteria.country_code or criteria.ph_min or criteria.ph_max or criteria.date_from or criteria.date_to %}
    <p class="text-muted">No results.</p>
  {% endif %}
{% endblock %}
